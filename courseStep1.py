"""
written by Alec Greaney, March 5-8, 2017
used a tutorial from Scrapy online
Check out EverNote for more info on how to use

to run via command prompt:
C:\Python27\Scripts\courses>C:\Python27\Scripts\scrapy crawl courseStep1 -o all1617other.jl
-->where courseStep1 is that name below; the file can be named whatever.jl (JSON lines)

"""

import scrapy

class CoursesSpider(scrapy.Spider):
        name = "courseStep1"
        #deptCodeTextArray = ["AADS", "ARTH", "BIOL", "UNCP", "CHEM", "CLAS","COMM","CSCI","UNCS","EESC","EALC","ECON","ENGL","ENVS","FILM","FREN","GERM","HIST","HONR","INTL","ICSP", "ITAL", "JESU","JOUR","LING","MATH","ROTC","MUSA","MUSP","NELC","PHIL","PHYS","POLI","PSYC","RLRL","SLAV","SOCY","SPAN","ARTS","THTR","THEO","UNAS"]
        #urlBase1 = "https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2017S%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017S%26selectedSort%3D%26selectedSchool%3D2MCAS%26selectedSubject%3D2"
        #urlBase2 = "%26selectedNumberRange%3D%26selectedLevel%3DAll%26selectedMeetingDay%3D%26selectedMeetingTime%3D%26selectedCourseStatus%3D%26selectedCourseCredit%3D%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue"

        #in this array, simply input the main list of the school
	start_urls = []

        start_urls.append("https://services.bc.edu/PublicCourseInfoSched/courseinfoschedResults!displayInput.action?authenticated=&keyword=&presentTerm=2017S&registrationTerm=2018F&termsString=2017S%2C2017U%2C2018F%2C2018S&selectedTerm=2018F&selectedSort=&selectedSchool=2MCAS&selectedSubject=All&selectedNumberRange=&selectedLevel=All&selectedMeetingDay=&selectedMeetingTime=&selectedCourseStatus=&selectedCourseCredit=&canvasSearchLink=https%3A%2F%2Fsyllabus-search.herokuapp.com%2Forganizations%2F1")
                          


	
	#start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2018F%26selectedSort%3D%26selectedSchool%3D2MCAS%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2017F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2018F%26selectedSort%3D%26selectedSchool%3D2MCAS%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        #below: spring17mcas
        #start_urls = ["https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2017S%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017S%26selectedSort%3D%26selectedSchool%3D2MCAS%26selectedSubject%3DAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue"]

        #below: fall16mcas
        #start_urls = ["https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017F%26selectedSort%3D%26selectedSchool%3D2MCAS%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue"]


        #below: fall16csom and spring17csom
        #start_urls = ["https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017F%26selectedSort%3D%26selectedSchool%3D6CSOM%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue","https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017S%26selectedSort%3D%26selectedSchool%3D6CSOM%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue"]

        #below: fall16csonURLs, spring17csonURLs,
        #       fall16lawURLs, spring17lawURLs, fall16lsoeURLs, spring17lsoeURLs,
        #       fall16soswURLs, spring17soswURLs, fall16sotmURLs, spring17sotmURLs,
        #       fall16wcasURLs, spring17wcasURLs
        '''
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017F%26selectedSort%3D%26selectedSchool%3D7CSON%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017S%26selectedSort%3D%26selectedSchool%3D7CSON%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017F%26selectedSort%3D%26selectedSchool%3D8LSOE%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017S%26selectedSort%3D%26selectedSchool%3D8LSOE%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017F%26selectedSort%3D%26selectedSchool%3D5SSW%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017S%26selectedSort%3D%26selectedSchool%3D5SSW%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017F%26selectedSort%3D%26selectedSchool%3D5SSW%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017S%26selectedSort%3D%26selectedSchool%3D5SSW%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017F%26selectedSort%3D%26selectedSchool%3D9STM%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017S%26selectedSort%3D%26selectedSchool%3D9STM%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017F%26selectedSort%3D%26selectedSchool%3D4ADV%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
        start_urls.append("https://portal.bc.edu/portal/page/portal/Public/CourseInformationSchedulePublic?_piref1735_33960448_1735_33962405_33962405.__ora_navig=authenticated%3D%26keyword%3D%26presentTerm%3D2017S%26registrationTerm%3D2018F%26termsString%3D2016U%25252C2017F%25252C2017S%26selectedTerm%3D2017F%26selectedSort%3D%26selectedSchool%3D4ADV%26selectedSubject%3DnullAll%26selectedNumberRange%3DAll%26selectedLevel%3DAll%26selectedMeetingDay%3DAll%26selectedMeetingTime%3DAll%26selectedCourseStatus%3DAll%26selectedCourseCredit%3DAll%26struts.portlet.action%3D%252Fcourseinfosched%252Fview%252Fmain%252FcourseinfoschedResults!displayInput%26struts.portlet.mode%3Dview%26struts.portlet.eventAction%3Dtrue")
	'''
	#below: fall17mcasURLS, fall17csomURLs, fall17csonURLs,fall17lsoeURLs, 
	#fall17lawURLs, fall17soswURLs, fall17sotmURLs, fal16wcasURLs

	
		
		
        '''
        for text in deptCodeTextArray:
        start_urls.append(urlBase1 + text + urlBase2)
        '''
    
        ##gets the course titles--> response.selector.xpath("//span[re:test(@class, 'course_title')]/strong/text()").extract()
        ##gets the course URLs  --> response.selector.xpath("//tr[re:test(@class, 'course')]/td[1]/a[1]/@href").extract()

        def parse(self, response):
        
                for course in response.css("body"):
                        yield{
                                'course': course.xpath("//tr[re:test(@class, 'course')]/td[1]/a[1]/@href").extract(),
                        }                   
        
